<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raspberry Pio Pico Drivers project: rpp_driver::I2sSlaveDuplex Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Raspberry Pio Pico Drivers project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacerpp__driver.html">rpp_driver</a></li><li class="navelem"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html">I2sSlaveDuplex</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">rpp_driver::I2sSlaveDuplex Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Duplex Slave I2S controller class.  
 <a href="classrpp__driver_1_1I2sSlaveDuplex.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="i2sslaveduplex_8hpp_source.html">i2sslaveduplex.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a651e7f5c0d28dce810e8a13cf148d4b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a651e7f5c0d28dce810e8a13cf148d4b1">I2sSlaveDuplex</a> (<a class="el" href="classrpp__driver_1_1SdkWrapper.html">::rpp_driver::SdkWrapper</a> &amp;sdk, <a class="el" href="sdkwrapper_8hpp.html#a72b2a6ed61ae397297f7c0b76866d797">PIO</a> pio, <a class="el" href="i2cmasterinterface_8hpp.html#a4d3943ddea65db7163a58e6c7e8df95a">uint</a> pin_base)</td></tr>
<tr class="memdesc:a651e7f5c0d28dce810e8a13cf148d4b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new Duplex Slave I2S object.  <br /></td></tr>
<tr class="separator:a651e7f5c0d28dce810e8a13cf148d4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e339ea483a3a2bd116c000d137b0493"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a5e339ea483a3a2bd116c000d137b0493">I2sSlaveDuplex</a> (<a class="el" href="classrpp__driver_1_1SdkWrapper.html">::rpp_driver::SdkWrapper</a> &amp;sdk, <a class="el" href="sdkwrapper_8hpp.html#a72b2a6ed61ae397297f7c0b76866d797">PIO</a> pio, uint32_t sm, <a class="el" href="i2cmasterinterface_8hpp.html#a4d3943ddea65db7163a58e6c7e8df95a">uint</a> pin_base)</td></tr>
<tr class="memdesc:a5e339ea483a3a2bd116c000d137b0493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new Duplex Slave I2S object.  <br /></td></tr>
<tr class="separator:a5e339ea483a3a2bd116c000d137b0493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42c65128e7d7c338563cf83e027d49a"><td class="memItemLeft" align="right" valign="top"><a id="ad42c65128e7d7c338563cf83e027d49a" name="ad42c65128e7d7c338563cf83e027d49a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>~I2sSlaveDuplex</b> ()</td></tr>
<tr class="memdesc:ad42c65128e7d7c338563cf83e027d49a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unclaim the state machine. No actual processing. <br /></td></tr>
<tr class="separator:ad42c65128e7d7c338563cf83e027d49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784c49bf0041d2c9000e347e0b1f4335"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a784c49bf0041d2c9000e347e0b1f4335">Start</a> ()</td></tr>
<tr class="memdesc:a784c49bf0041d2c9000e347e0b1f4335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the I2S port, and run.  <br /></td></tr>
<tr class="separator:a784c49bf0041d2c9000e347e0b1f4335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15e899964a87eb08d1cf610ad381aac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#aa15e899964a87eb08d1cf610ad381aac">Stop</a> ()</td></tr>
<tr class="memdesc:aa15e899964a87eb08d1cf610ad381aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the I2S port and disable the PIO state machine in use.  <br /></td></tr>
<tr class="separator:aa15e899964a87eb08d1cf610ad381aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8baa9c14d682f394356a2dac2dbf5dc"><td class="memItemLeft" align="right" valign="top">virtual uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#ab8baa9c14d682f394356a2dac2dbf5dc">GetStateMachine</a> ()</td></tr>
<tr class="memdesc:ab8baa9c14d682f394356a2dac2dbf5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the State Machine object.  <br /></td></tr>
<tr class="separator:ab8baa9c14d682f394356a2dac2dbf5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23a129241f343244523a2d15543c65de"><td class="memItemLeft" align="right" valign="top">virtual int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a23a129241f343244523a2d15543c65de">GetFifoBlocking</a> ()</td></tr>
<tr class="memdesc:a23a129241f343244523a2d15543c65de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get one audio data from RX FIFO.  <br /></td></tr>
<tr class="separator:a23a129241f343244523a2d15543c65de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21bef4e09320b995dfd6c9ced6acea5e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a21bef4e09320b995dfd6c9ced6acea5e">PutFifoBlocking</a> (int32_t value)</td></tr>
<tr class="memdesc:a21bef4e09320b995dfd6c9ced6acea5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put one audio data to TX FIFO.  <br /></td></tr>
<tr class="separator:a21bef4e09320b995dfd6c9ced6acea5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Duplex Slave I2S controller class. </p>
<p>This class supports the duplex communication of the I2S on the PIO port of the RP2040/2350 SoC MCU.</p>
<p>The timing signal (BCLK and WS) of the I2S must be provided from the external device. This class supports up to 192kHz Fs if the MCU system clock is higher than 120MHz.</p>
<p>The I2S pins can be mapped on the GPIO. This mapping is based on the pin_base parameter of the constructors.</p>
<p>The pin_base parameter of the constructors is the first pin of 4 I2S signals. The signals must be consecutive on the GPIO pins as like :</p><ol type="1">
<li>SDOUT</li>
<li>SDIN</li>
<li>BCLK</li>
<li>WS</li>
</ol>
<p>For example, let's assume SDTOUT is GPIO 15. Then, SDIN, BCLK and WS are GPIO 16, 17 and 18 respectively.</p>
<p>To start and stop the I2S transfer, call the <a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a784c49bf0041d2c9000e347e0b1f4335" title="Initialize the I2S port, and run.">Start()</a> and the <a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#aa15e899964a87eb08d1cf610ad381aac" title="Stop the I2S port and disable the PIO state machine in use.">Stop()</a> member functions respectively.</p>
<p>The audio sample in and out are through the <a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a23a129241f343244523a2d15543c65de" title="Get one audio data from RX FIFO.">GetFifoBlocking()</a> and the <a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a21bef4e09320b995dfd6c9ced6acea5e" title="Put one audio data to TX FIFO.">PutFifoBlocking()</a> member functions, respectively. These are blocking function. That mean, program will wait until the data is ready, or FIFO has room for data.</p>
<p>This class assumes polling based data transfer instead of interrupt / DMA based data transfer.</p>
<p>Typically, program process the signal obtained from GetFifoBLock() and output to PutFifoBLock(). To provide the high quality processing, The first <a class="el" href="classrpp__driver_1_1I2sSlaveDuplex.html#a23a129241f343244523a2d15543c65de" title="Get one audio data from RX FIFO.">GetFifoBlocking()</a> call should be as soon as possible, after calling start() function. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a651e7f5c0d28dce810e8a13cf148d4b1" name="a651e7f5c0d28dce810e8a13cf148d4b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651e7f5c0d28dce810e8a13cf148d4b1">&#9670;&#160;</a></span>I2sSlaveDuplex() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpp_driver::I2sSlaveDuplex::I2sSlaveDuplex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrpp__driver_1_1SdkWrapper.html">::rpp_driver::SdkWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>sdk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sdkwrapper_8hpp.html#a72b2a6ed61ae397297f7c0b76866d797">PIO</a>&#160;</td>
          <td class="paramname"><em>pio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="i2cmasterinterface_8hpp.html#a4d3943ddea65db7163a58e6c7e8df95a">uint</a>&#160;</td>
          <td class="paramname"><em>pin_base</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new Duplex Slave I2S object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdk</td><td>SDK wrapper class injection. </td></tr>
    <tr><td class="paramname">pio</td><td>PIO to use. </td></tr>
    <tr><td class="paramname">pin_base</td><td>The GPIO pin number of SDOUT signal.</td></tr>
  </table>
  </dd>
</dl>
<p>The state machine number is not specified in this constructor. Internally, the state machine will be allocate from the unused one.</p>
<p>This constructor just registers the given parameters and allocated state machine to the internal parameters. And then, claim the state machine. No other processing will be done. </p>

</div>
</div>
<a id="a5e339ea483a3a2bd116c000d137b0493" name="a5e339ea483a3a2bd116c000d137b0493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e339ea483a3a2bd116c000d137b0493">&#9670;&#160;</a></span>I2sSlaveDuplex() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpp_driver::I2sSlaveDuplex::I2sSlaveDuplex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrpp__driver_1_1SdkWrapper.html">::rpp_driver::SdkWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>sdk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sdkwrapper_8hpp.html#a72b2a6ed61ae397297f7c0b76866d797">PIO</a>&#160;</td>
          <td class="paramname"><em>pio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="i2cmasterinterface_8hpp.html#a4d3943ddea65db7163a58e6c7e8df95a">uint</a>&#160;</td>
          <td class="paramname"><em>pin_base</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new Duplex Slave I2S object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdk</td><td>SDK wrapper class injection. </td></tr>
    <tr><td class="paramname">pio</td><td>PIO to use. </td></tr>
    <tr><td class="paramname">sm</td><td>State machine to use. </td></tr>
    <tr><td class="paramname">pin_base</td><td>The GPIO pin number of SDOUT signal.</td></tr>
  </table>
  </dd>
</dl>
<p>This constructor just registers the given parameters to the internal parameters. And then, claim the state machine. No other processing will be done. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a23a129241f343244523a2d15543c65de" name="a23a129241f343244523a2d15543c65de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23a129241f343244523a2d15543c65de">&#9670;&#160;</a></span>GetFifoBlocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int32_t rpp_driver::I2sSlaveDuplex::GetFifoBlocking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get one audio data from RX FIFO. </p>
<dl class="section return"><dt>Returns</dt><dd>int32_t An audio data.</dd></dl>
<p>To get one stere sample, call this member function twice. The left data will be given and then, right data.</p>
<p>This function is blocking. That mean, program will wait until the data has been received. </p>

</div>
</div>
<a id="ab8baa9c14d682f394356a2dac2dbf5dc" name="ab8baa9c14d682f394356a2dac2dbf5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8baa9c14d682f394356a2dac2dbf5dc">&#9670;&#160;</a></span>GetStateMachine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual uint32_t rpp_driver::I2sSlaveDuplex::GetStateMachine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the State Machine object. </p>
<dl class="section return"><dt>Returns</dt><dd>uint32_t The number of the state machine which is claimed.</dd></dl>
<p>This is convenient if the state machine is assigned internally. </p>

</div>
</div>
<a id="a21bef4e09320b995dfd6c9ced6acea5e" name="a21bef4e09320b995dfd6c9ced6acea5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21bef4e09320b995dfd6c9ced6acea5e">&#9670;&#160;</a></span>PutFifoBlocking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rpp_driver::I2sSlaveDuplex::PutFifoBlocking </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Put one audio data to TX FIFO. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>An audio data to send. To put one stere sample, call this member function twice. The left data must be put and then, right data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a784c49bf0041d2c9000e347e0b1f4335" name="a784c49bf0041d2c9000e347e0b1f4335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784c49bf0041d2c9000e347e0b1f4335">&#9670;&#160;</a></span>Start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rpp_driver::I2sSlaveDuplex::Start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the I2S port, and run. </p>
<p>Assign the GPIO, configure them, load the PIO program, configure the state machine and run. </p>

</div>
</div>
<a id="aa15e899964a87eb08d1cf610ad381aac" name="aa15e899964a87eb08d1cf610ad381aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa15e899964a87eb08d1cf610ad381aac">&#9670;&#160;</a></span>Stop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rpp_driver::I2sSlaveDuplex::Stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop the I2S port and disable the PIO state machine in use. </p>
<p>Make FIFOs empty. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/i2s/<a class="el" href="i2sslaveduplex_8hpp_source.html">i2sslaveduplex.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
